{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pilat\\\\OneDrive\\\\Documents\\\\GitHub\\\\react\\\\src\\\\App.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { usePlaidLink } from \"react-plaid-link\";\nimport \"./App.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App(props) {\n  _s();\n  const [token, setToken] = useState(null);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [processorToken, setProcessorToken] = useState(null); // add state variable for processorToken\n\n  const onSuccess = useCallback(async (publicToken, metadata) => {\n    setLoading(true);\n    await fetch(\"/api/exchange_public_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        public_token: publicToken\n      })\n    });\n    await fetch(\"/api/create_processor_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        public_token: publicToken,\n        account_id: metadata.accounts[0].id\n      })\n    }).then(response => response.json()).then(data => {\n      const processorToken = data.processor_token;\n      console.log(\"Token:\", processorToken);\n      setProcessorToken(processorToken); // set the processorToken state variable\n    }).catch(error => {\n      // handle error\n    });\n    await getBalance();\n  }, []);\n\n  // Creates a Link token\n  const createLinkToken = React.useCallback(async () => {\n    // For OAuth, use previously generated Link token\n    if (window.location.href.includes(\"?oauth_state_id=\")) {\n      const linkToken = localStorage.getItem('link_token');\n      setToken(linkToken);\n    } else {\n      const response = await fetch(\"/api/create_link_token\", {});\n      const data = await response.json();\n      setToken(data.link_token);\n      localStorage.setItem(\"link_token\", data.link_token);\n    }\n  }, [setToken]);\n\n  // Fetch balance data\n  const getBalance = React.useCallback(async () => {\n    setLoading(true);\n    const response = await fetch(\"/api/balance\", {});\n    const data = await response.json();\n    setData(data);\n    setLoading(false);\n  }, [setData, setLoading]);\n  let isOauth = false;\n  const config = {\n    token,\n    onSuccess\n  };\n\n  // For OAuth, configure the received redirect URI\n  if (window.location.href.includes(\"?oauth_state_id=\")) {\n    config.receivedRedirectUri = window.location.href;\n    isOauth = true;\n  }\n  const {\n    open,\n    ready\n  } = usePlaidLink(config);\n  useEffect(() => {\n    if (token == null) {\n      createLinkToken();\n    }\n    if (isOauth && ready) {\n      open();\n    }\n  }, [token, isOauth, ready, open]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const searchParams = new URLSearchParams(window.location.search);\n    const userid = searchParams.get(\"userid\");\n    const formData = new FormData(e.target);\n    const data = {};\n    for (let [key, value] of formData.entries()) {\n      data[key] = value;\n    }\n    data[\"userid\"] = userid;\n    await fetch(\"https://pzcoopmembersportal.kinsta.cloud/?wpwhreceivable_group=received_http_request&wpwhreceivable_name=wpwh-flow-30&wpwhreceivable=9nKDYUSw2xIxsMFlrUXk9VQ40zaeQ795G3ggYB73rAQ-\", {\n      method: \"POST\",\n      body: JSON.stringify(data),\n      mode: 'no-cors'\n    });\n    window.location.href = `https://pzcoopmembersportal.kinsta.cloud/`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"main\",\n    children: !loading && processorToken != null ? /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"congrats\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Great! Your bank account is set.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"hidden\",\n          name: \"token\",\n          value: processorToken\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: \"Continue to My Account\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Let's connect your bank account, click the button below to get started:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 1\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => open(),\n        disabled: !ready,\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Link account\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 1\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 3\n  }, this);\n}\n_s(App, \"u7uQQE3CHOtiyvw57gqJrXTSfIQ=\", false, function () {\n  return [usePlaidLink];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","usePlaidLink","jsxDEV","_jsxDEV","App","props","_s","token","setToken","data","setData","loading","setLoading","processorToken","setProcessorToken","onSuccess","publicToken","metadata","fetch","method","headers","body","JSON","stringify","public_token","account_id","accounts","id","then","response","json","processor_token","console","log","catch","error","getBalance","createLinkToken","window","location","href","includes","linkToken","localStorage","getItem","link_token","setItem","isOauth","config","receivedRedirectUri","open","ready","handleSubmit","e","preventDefault","searchParams","URLSearchParams","search","userid","get","formData","FormData","target","key","value","entries","mode","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/pilat/OneDrive/Documents/GitHub/react/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { usePlaidLink } from \"react-plaid-link\";\nimport \"./App.scss\";\n\nfunction App(props) {\n  const [token, setToken] = useState(null);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\nconst [processorToken, setProcessorToken] = useState(null); // add state variable for processorToken\n\n  const onSuccess = useCallback(async (publicToken, metadata) => {\n    setLoading(true);\n    await fetch(\"/api/exchange_public_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ public_token: publicToken }),\n    });\nawait fetch(\"/api/create_processor_token\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ public_token: publicToken, account_id: metadata.accounts[0].id }),\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      const processorToken = data.processor_token;\nconsole.log(\"Token:\", processorToken);\nsetProcessorToken(processorToken); // set the processorToken state variable\n\n    })\n    .catch((error) => {\n      // handle error\n    });\n\n    await getBalance();\n  }, []);\n\n  // Creates a Link token\n  const createLinkToken = React.useCallback(async () => {\n    // For OAuth, use previously generated Link token\n    if (window.location.href.includes(\"?oauth_state_id=\")) {\n      const linkToken = localStorage.getItem('link_token');\n      setToken(linkToken);\n    } else {\n      const response = await fetch(\"/api/create_link_token\", {});\n      const data = await response.json();\n      setToken(data.link_token);\n      localStorage.setItem(\"link_token\", data.link_token);\n    }\n  }, [setToken]);\n\n  // Fetch balance data\n  const getBalance = React.useCallback(async () => {\n    setLoading(true);\n    const response = await fetch(\"/api/balance\", {});\n    const data = await response.json();\n    setData(data);\n    setLoading(false);\n  }, [setData, setLoading]);\n\n  let isOauth = false;\n\n  const config = {\n    token,\n    onSuccess,\n  };\n\n  // For OAuth, configure the received redirect URI\n  if (window.location.href.includes(\"?oauth_state_id=\")) {\n    config.receivedRedirectUri = window.location.href;\n    isOauth = true;\n  }\n  const { open, ready } = usePlaidLink(config);\n\n  useEffect(() => {\n    if (token == null) {\n      createLinkToken();\n    }\n    if (isOauth && ready) {\n      open();\n    }\n  }, [token, isOauth, ready, open]);\n\n\n const handleSubmit = async (e) => {\n    e.preventDefault();\n\n  const searchParams = new URLSearchParams(window.location.search);\n  const userid = searchParams.get(\"userid\");\n\n\n    const formData = new FormData(e.target);\n    const data = {};\n\n    for (let [key, value] of formData.entries()) {\n      data[key] = value;\n    }\n  data[\"userid\"] = userid;\n\n    await fetch(\"https://pzcoopmembersportal.kinsta.cloud/?wpwhreceivable_group=received_http_request&wpwhreceivable_name=wpwh-flow-30&wpwhreceivable=9nKDYUSw2xIxsMFlrUXk9VQ40zaeQ795G3ggYB73rAQ-\", {\n      method: \"POST\",\n      body: JSON.stringify(data),\n\tmode: 'no-cors',\n  });\n\n    window.location.href = `https://pzcoopmembersportal.kinsta.cloud/`;\n  };\n\n\nreturn (\n  <div id=\"main\">\n\n    {!loading && processorToken != null ? (\n      <div id=\"congrats\">\n        <h4>Great! Your bank account is set.</h4>\n        <form onSubmit={handleSubmit}>\n          <input type=\"hidden\" name=\"token\" value={processorToken} />\n          <button type=\"submit\">Continue to My Account</button>\n        </form>\n      </div>\n    ) : (\n<div>\n<h4>Let's connect your bank account, click the button below to get started:</h4>\n      <button onClick={() => open()} disabled={!ready}>\n        <strong>Link account</strong>\n      </button>\n</div>\n    )}\n  </div>\n);\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}