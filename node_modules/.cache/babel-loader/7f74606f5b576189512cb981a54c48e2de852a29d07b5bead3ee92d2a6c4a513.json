{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pilat\\\\OneDrive\\\\Documents\\\\GitHub\\\\react\\\\src\\\\App.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { usePlaidLink } from \"react-plaid-link\";\nimport \"./App.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App(props) {\n  _s();\n  const [token, setToken] = useState(null);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [processorToken, setProcessorToken] = useState(null); // add state variable for processorToken\n\n  const onSuccess = useCallback(async (publicToken, metadata) => {\n    setLoading(true);\n    await fetch(\"/api/exchange_public_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        public_token: publicToken\n      })\n    });\n    await fetch(\"/api/create_processor_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        public_token: publicToken,\n        account_id: metadata.accounts[0].id\n      })\n    }).then(response => response.json()).then(data => {\n      const processorToken = data.processor_token;\n      const requestId = data.request_id;\n      console.log(\"Token:\", processorToken);\n      console.log(\"Request:\", requestId);\n      setProcessorToken(processorToken); // set the processorToken state variable\n      setrequestId(requestId); // set the processorToken state variable\n    }).catch(error => {\n      // handle error\n    });\n    await getBalance();\n  }, []);\n\n  // Creates a Link token\n  const createLinkToken = React.useCallback(async () => {\n    // For OAuth, use previously generated Link token\n    if (window.location.href.includes(\"?oauth_state_id=\")) {\n      const linkToken = localStorage.getItem('link_token');\n      setToken(linkToken);\n    } else {\n      const response = await fetch(\"/api/create_link_token\", {});\n      const data = await response.json();\n      setToken(data.link_token);\n      localStorage.setItem(\"link_token\", data.link_token);\n    }\n  }, [setToken]);\n\n  // Fetch balance data\n  const getBalance = React.useCallback(async () => {\n    setLoading(true);\n    const response = await fetch(\"/api/balance\", {});\n    const data = await response.json();\n    setData(data);\n    setLoading(false);\n  }, [setData, setLoading]);\n  let isOauth = false;\n  const config = {\n    token,\n    onSuccess\n  };\n\n  // For OAuth, configure the received redirect URI\n  if (window.location.href.includes(\"?oauth_state_id=\")) {\n    config.receivedRedirectUri = window.location.href;\n    isOauth = true;\n  }\n  const {\n    open,\n    ready\n  } = usePlaidLink(config);\n  useEffect(() => {\n    if (token == null) {\n      createLinkToken();\n    }\n    if (isOauth && ready) {\n      open();\n    }\n  }, [token, isOauth, ready, open]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const searchParams = new URLSearchParams(window.location.search);\n    const userid = searchParams.get(\"userid\");\n    const formData = new FormData(e.target);\n    const data = {};\n    for (let [key, value] of formData.entries()) {\n      data[key] = value;\n    }\n    data[\"userid\"] = userid;\n    await fetch(\"https://pzcoopmembersportal.kinsta.cloud/?wpwhreceivable_group=received_http_request&wpwhreceivable_name=wpwh-flow-30&wpwhreceivable=9nKDYUSw2xIxsMFlrUXk9VQ40zaeQ795G3ggYB73rAQ-\", {\n      method: \"POST\",\n      body: JSON.stringify(data),\n      mode: 'no-cors'\n    });\n    window.location.href = `https://pzcoopmembersportal.kinsta.cloud/`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => open(),\n      disabled: !ready,\n      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Link account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this), !loading && processorToken != null && /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"hidden\",\n        name: \"token\",\n        value: processorToken\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Continue\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"u7uQQE3CHOtiyvw57gqJrXTSfIQ=\", false, function () {\n  return [usePlaidLink];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","usePlaidLink","jsxDEV","_jsxDEV","App","props","_s","token","setToken","data","setData","loading","setLoading","processorToken","setProcessorToken","onSuccess","publicToken","metadata","fetch","method","headers","body","JSON","stringify","public_token","account_id","accounts","id","then","response","json","processor_token","requestId","request_id","console","log","setrequestId","catch","error","getBalance","createLinkToken","window","location","href","includes","linkToken","localStorage","getItem","link_token","setItem","isOauth","config","receivedRedirectUri","open","ready","handleSubmit","e","preventDefault","searchParams","URLSearchParams","search","userid","get","formData","FormData","target","key","value","entries","mode","children","onClick","disabled","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","_c","$RefreshReg$"],"sources":["C:/Users/pilat/OneDrive/Documents/GitHub/react/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { usePlaidLink } from \"react-plaid-link\";\nimport \"./App.scss\";\n\nfunction App(props) {\n  const [token, setToken] = useState(null);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\nconst [processorToken, setProcessorToken] = useState(null); // add state variable for processorToken\n\n  const onSuccess = useCallback(async (publicToken, metadata) => {\n    setLoading(true);\n    await fetch(\"/api/exchange_public_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ public_token: publicToken }),\n    });\nawait fetch(\"/api/create_processor_token\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ public_token: publicToken, account_id: metadata.accounts[0].id }),\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      const processorToken = data.processor_token;\nconst requestId = data.request_id;\nconsole.log(\"Token:\", processorToken);\nconsole.log(\"Request:\", requestId);\nsetProcessorToken(processorToken); // set the processorToken state variable\nsetrequestId(requestId); // set the processorToken state variable\n    })\n    .catch((error) => {\n      // handle error\n    });\n\n    await getBalance();\n  }, []);\n\n  // Creates a Link token\n  const createLinkToken = React.useCallback(async () => {\n    // For OAuth, use previously generated Link token\n    if (window.location.href.includes(\"?oauth_state_id=\")) {\n      const linkToken = localStorage.getItem('link_token');\n      setToken(linkToken);\n    } else {\n      const response = await fetch(\"/api/create_link_token\", {});\n      const data = await response.json();\n      setToken(data.link_token);\n      localStorage.setItem(\"link_token\", data.link_token);\n    }\n  }, [setToken]);\n\n  // Fetch balance data\n  const getBalance = React.useCallback(async () => {\n    setLoading(true);\n    const response = await fetch(\"/api/balance\", {});\n    const data = await response.json();\n    setData(data);\n    setLoading(false);\n  }, [setData, setLoading]);\n\n  let isOauth = false;\n\n  const config = {\n    token,\n    onSuccess,\n  };\n\n  // For OAuth, configure the received redirect URI\n  if (window.location.href.includes(\"?oauth_state_id=\")) {\n    config.receivedRedirectUri = window.location.href;\n    isOauth = true;\n  }\n  const { open, ready } = usePlaidLink(config);\n\n  useEffect(() => {\n    if (token == null) {\n      createLinkToken();\n    }\n    if (isOauth && ready) {\n      open();\n    }\n  }, [token, isOauth, ready, open]);\n\n\n const handleSubmit = async (e) => {\n    e.preventDefault();\n\n  const searchParams = new URLSearchParams(window.location.search);\n  const userid = searchParams.get(\"userid\");\n\n\n    const formData = new FormData(e.target);\n    const data = {};\n\n    for (let [key, value] of formData.entries()) {\n      data[key] = value;\n    }\n  data[\"userid\"] = userid;\n\n    await fetch(\"https://pzcoopmembersportal.kinsta.cloud/?wpwhreceivable_group=received_http_request&wpwhreceivable_name=wpwh-flow-30&wpwhreceivable=9nKDYUSw2xIxsMFlrUXk9VQ40zaeQ795G3ggYB73rAQ-\", {\n      method: \"POST\",\n      body: JSON.stringify(data),\n\tmode: 'no-cors',\n  });\n\n    window.location.href = `https://pzcoopmembersportal.kinsta.cloud/`;\n  };\n\n\n  return (\n    <div>\n      <button onClick={() => open()} disabled={!ready}>\n        <strong>Link account</strong>\n      </button>\n\n      {!loading && processorToken != null && (\n    <form onSubmit={handleSubmit}>\n      <input type=\"hidden\" name=\"token\" value={processorToken} />\n      <button type=\"submit\">Continue</button>\n    </form>\n  )}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAC/D,SAASC,YAAY,QAAQ,kBAAkB;AAC/C,OAAO,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpB,SAASC,GAAGA,CAACC,KAAK,EAAE;EAAAC,EAAA;EAClB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACW,IAAI,EAAEC,OAAO,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAC9C,MAAM,CAACe,cAAc,EAAEC,iBAAiB,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;;EAE1D,MAAMiB,SAAS,GAAGf,WAAW,CAAC,OAAOgB,WAAW,EAAEC,QAAQ,KAAK;IAC7DL,UAAU,CAAC,IAAI,CAAC;IAChB,MAAMM,KAAK,CAAC,4BAA4B,EAAE;MACxCC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEC,YAAY,EAAER;MAAY,CAAC;IACpD,CAAC,CAAC;IACN,MAAME,KAAK,CAAC,6BAA6B,EAAE;MACvCC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QAAEC,YAAY,EAAER,WAAW;QAAES,UAAU,EAAER,QAAQ,CAACS,QAAQ,CAAC,CAAC,CAAC,CAACC;MAAG,CAAC;IACzF,CAAC,CAAC,CACCC,IAAI,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,EAAE,CAAC,CACnCF,IAAI,CAAEnB,IAAI,IAAK;MACd,MAAMI,cAAc,GAAGJ,IAAI,CAACsB,eAAe;MACjD,MAAMC,SAAS,GAAGvB,IAAI,CAACwB,UAAU;MACjCC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEtB,cAAc,CAAC;MACrCqB,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEH,SAAS,CAAC;MAClClB,iBAAiB,CAACD,cAAc,CAAC,CAAC,CAAC;MACnCuB,YAAY,CAACJ,SAAS,CAAC,CAAC,CAAC;IACrB,CAAC,CAAC,CACDK,KAAK,CAAEC,KAAK,IAAK;MAChB;IAAA,CACD,CAAC;IAEF,MAAMC,UAAU,EAAE;EACpB,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMC,eAAe,GAAG3C,KAAK,CAACG,WAAW,CAAC,YAAY;IACpD;IACA,IAAIyC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAAC,kBAAkB,CAAC,EAAE;MACrD,MAAMC,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC;MACpDvC,QAAQ,CAACqC,SAAS,CAAC;IACrB,CAAC,MAAM;MACL,MAAMhB,QAAQ,GAAG,MAAMX,KAAK,CAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC;MAC1D,MAAMT,IAAI,GAAG,MAAMoB,QAAQ,CAACC,IAAI,EAAE;MAClCtB,QAAQ,CAACC,IAAI,CAACuC,UAAU,CAAC;MACzBF,YAAY,CAACG,OAAO,CAAC,YAAY,EAAExC,IAAI,CAACuC,UAAU,CAAC;IACrD;EACF,CAAC,EAAE,CAACxC,QAAQ,CAAC,CAAC;;EAEd;EACA,MAAM+B,UAAU,GAAG1C,KAAK,CAACG,WAAW,CAAC,YAAY;IAC/CY,UAAU,CAAC,IAAI,CAAC;IAChB,MAAMiB,QAAQ,GAAG,MAAMX,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;IAChD,MAAMT,IAAI,GAAG,MAAMoB,QAAQ,CAACC,IAAI,EAAE;IAClCpB,OAAO,CAACD,IAAI,CAAC;IACbG,UAAU,CAAC,KAAK,CAAC;EACnB,CAAC,EAAE,CAACF,OAAO,EAAEE,UAAU,CAAC,CAAC;EAEzB,IAAIsC,OAAO,GAAG,KAAK;EAEnB,MAAMC,MAAM,GAAG;IACb5C,KAAK;IACLQ;EACF,CAAC;;EAED;EACA,IAAI0B,MAAM,CAACC,QAAQ,CAACC,IAAI,CAACC,QAAQ,CAAC,kBAAkB,CAAC,EAAE;IACrDO,MAAM,CAACC,mBAAmB,GAAGX,MAAM,CAACC,QAAQ,CAACC,IAAI;IACjDO,OAAO,GAAG,IAAI;EAChB;EACA,MAAM;IAAEG,IAAI;IAAEC;EAAM,CAAC,GAAGrD,YAAY,CAACkD,MAAM,CAAC;EAE5CpD,SAAS,CAAC,MAAM;IACd,IAAIQ,KAAK,IAAI,IAAI,EAAE;MACjBiC,eAAe,EAAE;IACnB;IACA,IAAIU,OAAO,IAAII,KAAK,EAAE;MACpBD,IAAI,EAAE;IACR;EACF,CAAC,EAAE,CAAC9C,KAAK,EAAE2C,OAAO,EAAEI,KAAK,EAAED,IAAI,CAAC,CAAC;EAGlC,MAAME,YAAY,GAAG,MAAOC,CAAC,IAAK;IAC/BA,CAAC,CAACC,cAAc,EAAE;IAEpB,MAAMC,YAAY,GAAG,IAAIC,eAAe,CAAClB,MAAM,CAACC,QAAQ,CAACkB,MAAM,CAAC;IAChE,MAAMC,MAAM,GAAGH,YAAY,CAACI,GAAG,CAAC,QAAQ,CAAC;IAGvC,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAACR,CAAC,CAACS,MAAM,CAAC;IACvC,MAAMxD,IAAI,GAAG,CAAC,CAAC;IAEf,KAAK,IAAI,CAACyD,GAAG,EAAEC,KAAK,CAAC,IAAIJ,QAAQ,CAACK,OAAO,EAAE,EAAE;MAC3C3D,IAAI,CAACyD,GAAG,CAAC,GAAGC,KAAK;IACnB;IACF1D,IAAI,CAAC,QAAQ,CAAC,GAAGoD,MAAM;IAErB,MAAM3C,KAAK,CAAC,mLAAmL,EAAE;MAC/LC,MAAM,EAAE,MAAM;MACdE,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACd,IAAI,CAAC;MAC/B4D,IAAI,EAAE;IACL,CAAC,CAAC;IAEA5B,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAI,2CAA0C;EACpE,CAAC;EAGD,oBACExC,OAAA;IAAAmE,QAAA,gBACEnE,OAAA;MAAQoE,OAAO,EAAEA,CAAA,KAAMlB,IAAI,EAAG;MAACmB,QAAQ,EAAE,CAAClB,KAAM;MAAAgB,QAAA,eAC9CnE,OAAA;QAAAmE,QAAA,EAAQ;MAAY;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IAAS;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QACtB,EAER,CAACjE,OAAO,IAAIE,cAAc,IAAI,IAAI,iBACrCV,OAAA;MAAM0E,QAAQ,EAAEtB,YAAa;MAAAe,QAAA,gBAC3BnE,OAAA;QAAO2E,IAAI,EAAC,QAAQ;QAACC,IAAI,EAAC,OAAO;QAACZ,KAAK,EAAEtD;MAAe;QAAA4D,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAG,eAC3DzE,OAAA;QAAQ2E,IAAI,EAAC,QAAQ;QAAAR,QAAA,EAAC;MAAQ;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAS;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAE1C;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACO;AAEV;AAACtE,EAAA,CA5HQF,GAAG;EAAA,QAyEcH,YAAY;AAAA;AAAA+E,EAAA,GAzE7B5E,GAAG;AA8HZ,eAAeA,GAAG;AAAC,IAAA4E,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}