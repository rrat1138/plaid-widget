{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pilat\\\\OneDrive\\\\Documents\\\\GitHub\\\\react\\\\src\\\\App.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { usePlaidLink } from \"react-plaid-link\";\nimport { Redirect } from \"react-router-dom\";\nimport \"./App.scss\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App(props) {\n  _s();\n  const [token, setToken] = useState(null);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [processorToken, setProcessorToken] = useState(null); // add state variable for processorToken\n  const [redirect, setRedirect] = useState(false); // add redirect state\n\n  const onSuccess = useCallback(async (publicToken, metadata) => {\n    setLoading(true);\n    await fetch(\"/api/exchange_public_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        public_token: publicToken\n      })\n    });\n    await fetch(\"/api/create_processor_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        public_token: publicToken,\n        account_id: metadata.accounts[0].id\n      })\n    }).then(response => response.json()).then(data => {\n      const processorToken = data.processor_token;\n      console.log(\"Token:\", processorToken);\n      setProcessorToken(processorToken); // set the processorToken state variable\n    }).catch(error => {\n      // handle error\n    });\n    await getBalance();\n  }, []);\n\n  // Creates a Link token\n  const createLinkToken = React.useCallback(async () => {\n    // For OAuth, use previously generated Link token\n    if (window.location.href.includes(\"?oauth_state_id=\")) {\n      const linkToken = localStorage.getItem('link_token');\n      setToken(linkToken);\n    } else {\n      const response = await fetch(\"/api/create_link_token\", {});\n      const data = await response.json();\n      setToken(data.link_token);\n      localStorage.setItem(\"link_token\", data.link_token);\n    }\n  }, [setToken]);\n\n  // Fetch balance data\n  const getBalance = React.useCallback(async () => {\n    setLoading(true);\n    const response = await fetch(\"/api/balance\", {});\n    const data = await response.json();\n    setData(data);\n    setLoading(false);\n  }, [setData, setLoading]);\n  let isOauth = false;\n  const config = {\n    token,\n    onSuccess\n  };\n\n  // For OAuth, configure the received redirect URI\n  if (window.location.href.includes(\"?oauth_state_id=\")) {\n    config.receivedRedirectUri = window.location.href;\n    isOauth = true;\n  }\n  const {\n    open,\n    ready\n  } = usePlaidLink(config);\n  useEffect(() => {\n    if (token == null) {\n      createLinkToken();\n    }\n    if (isOauth && ready) {\n      open();\n    }\n  }, [token, isOauth, ready, open]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const formData = new FormData(e.target);\n    const data = {};\n    for (let [key, value] of formData.entries()) {\n      data[key] = value;\n    }\n    await fetch(\"https://pzcoopmembersportal.kinsta.cloud/?wpwhreceivable_group=received_http_request&wpwhreceivable_name=wpwh-flow-30&wpwhreceivable=9nKDYUSw2xIxsMFlrUXk9VQ40zaeQ795G3ggYB73rAQ-\", {\n      method: \"POST\",\n      body: JSON.stringify(data)\n    });\n    window.location.href = `https://pzcoopmembersportal.kinsta.cloud/?token=${processorToken}`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => open(),\n      disabled: !ready,\n      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Link account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), !loading && processorToken != null && /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"hidden\",\n        name: \"token\",\n        value: processorToken\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Continue\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"3Eqw11WZZ8Ji2VupYbHpDIIYsno=\", false, function () {\n  return [usePlaidLink];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","usePlaidLink","Redirect","jsxDEV","_jsxDEV","App","props","_s","token","setToken","data","setData","loading","setLoading","processorToken","setProcessorToken","redirect","setRedirect","onSuccess","publicToken","metadata","fetch","method","headers","body","JSON","stringify","public_token","account_id","accounts","id","then","response","json","processor_token","console","log","catch","error","getBalance","createLinkToken","window","location","href","includes","linkToken","localStorage","getItem","link_token","setItem","isOauth","config","receivedRedirectUri","open","ready","handleSubmit","e","preventDefault","formData","FormData","target","key","value","entries","children","onClick","disabled","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","name","_c","$RefreshReg$"],"sources":["C:/Users/pilat/OneDrive/Documents/GitHub/react/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { usePlaidLink } from \"react-plaid-link\";\nimport { Redirect } from \"react-router-dom\";\nimport \"./App.scss\";\n\nfunction App(props) {\n  const [token, setToken] = useState(null);\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(true);\nconst [processorToken, setProcessorToken] = useState(null); // add state variable for processorToken\nconst [redirect, setRedirect] = useState(false); // add redirect state\n\n  const onSuccess = useCallback(async (publicToken, metadata) => {\n    setLoading(true);\n    await fetch(\"/api/exchange_public_token\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ public_token: publicToken }),\n    });\nawait fetch(\"/api/create_processor_token\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ public_token: publicToken, account_id: metadata.accounts[0].id }),\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      const processorToken = data.processor_token;\nconsole.log(\"Token:\", processorToken);\nsetProcessorToken(processorToken); // set the processorToken state variable\n    })\n    .catch((error) => {\n      // handle error\n    });\n\n    await getBalance();\n  }, []);\n\n  // Creates a Link token\n  const createLinkToken = React.useCallback(async () => {\n    // For OAuth, use previously generated Link token\n    if (window.location.href.includes(\"?oauth_state_id=\")) {\n      const linkToken = localStorage.getItem('link_token');\n      setToken(linkToken);\n    } else {\n      const response = await fetch(\"/api/create_link_token\", {});\n      const data = await response.json();\n      setToken(data.link_token);\n      localStorage.setItem(\"link_token\", data.link_token);\n    }\n  }, [setToken]);\n\n  // Fetch balance data\n  const getBalance = React.useCallback(async () => {\n    setLoading(true);\n    const response = await fetch(\"/api/balance\", {});\n    const data = await response.json();\n    setData(data);\n    setLoading(false);\n  }, [setData, setLoading]);\n\n  let isOauth = false;\n\n  const config = {\n    token,\n    onSuccess,\n  };\n\n  // For OAuth, configure the received redirect URI\n  if (window.location.href.includes(\"?oauth_state_id=\")) {\n    config.receivedRedirectUri = window.location.href;\n    isOauth = true;\n  }\n  const { open, ready } = usePlaidLink(config);\n\n  useEffect(() => {\n    if (token == null) {\n      createLinkToken();\n    }\n    if (isOauth && ready) {\n      open();\n    }\n  }, [token, isOauth, ready, open]);\n\n\n const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const formData = new FormData(e.target);\n    const data = {};\n\n    for (let [key, value] of formData.entries()) {\n      data[key] = value;\n    }\n\n    await fetch(\"https://pzcoopmembersportal.kinsta.cloud/?wpwhreceivable_group=received_http_request&wpwhreceivable_name=wpwh-flow-30&wpwhreceivable=9nKDYUSw2xIxsMFlrUXk9VQ40zaeQ795G3ggYB73rAQ-\", {\n      method: \"POST\",\n      body: JSON.stringify(data),\n    });\n\n    window.location.href = `https://pzcoopmembersportal.kinsta.cloud/?token=${processorToken}`;\n  };\n\n\n  return (\n    <div>\n      <button onClick={() => open()} disabled={!ready}>\n        <strong>Link account</strong>\n      </button>\n\n      {!loading && processorToken != null && (\n    <form onSubmit={handleSubmit}>\n      <input type=\"hidden\" name=\"token\" value={processorToken} />\n      <button type=\"submit\">Continue</button>\n    </form>\n  )}\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}